#include "TROOT.h"
#include "TH1.h"
#include "TTree.h"
#include "TH2.h"
#include "TAxis.h"
#include "TF1.h"
#include "TFile.h"
#include "TMath.h"
#include "TSystem.h"
#include "TVector2.h"
#include "TLorentzVector.h"
#include "TVector3.h"
#include "TRandom.h"
#include <iostream>
#include <fstream>


using namespace std;

int evtid;
float X1;
float X2;
float Y1;
float Y2;
float Z1;
float Z2;
float T1;
float T2;
float BHBLedep;
float BHFLedep;
float FEMCALedep;
int hitid;
int trkid;
int showerid;
int layer;	
//double MinDepthZFT = 305.1;
double MinDepthZ = 304.005;
double scalefactor;
double WRadLength = 0.35; //cm
double SamFrac = 0.25;  
double ScinThick = 0.14;


double TotalEMin;
double TotalEMax;


double MinDepthX = 50.0;
double MinDepthY = 50.0;
double MinDepthXY;

double eta = 2.0;
double phi = 0.0;


double MinDepthXYFT;


const int NPoints1GeV = 75;

double EdepCurve1GeVX[NPoints1GeV+1] = {0,0.148717,0.320847,0.550973,0.838831,1.125625,1.415877,1.648930,1.937320,2.223848,2.455038,2.685963,2.968234,3.194104,3.474513,3.754921,3.976801,4.142545,4.476428,4.642439,4.974459,5.196605,5.471427,5.747046,5.910130,6.130680,6.462168,6.627115,6.958603,7.178620,7.399169,7.564116,7.896935,8.171224,8.393104,8.670852,8.891401,9.169149,9.389698,9.610513,9.831595,10.16468,10.38815,10.60976,10.83138,11.10939,11.33154,11.60982,11.83249,12.16638,12.44439,12.83414,13.11269,13.39097,13.61312,13.89166,14.11407,14.39342,14.56049,14.83957,15.11838,15.34159,15.67681,16.06656,16.34537,16.62418,17.12647,17.46195,17.79663,18.13131,18.52240,18.96908,19.24816,19.58337,19.97419,20.47674};

double EdepCurve1GeVY[NPoints1GeV+1] = {0,1.3340,1.9829,2.93710,4.15834,5.22720,6.79131,8.16452,9.46195,10.4927,11.5992,12.6676,13.0888,13.4334,13.5879,13.7424,13.5155,13.25018,13.06225,12.83494,12.38033,12.19155,11.54602,11.01479,10.368415,9.951048,9.420240,9.040544,8.509737,8.016175,7.59880,7.219112,6.8787911,6.157071,5.930190,5.703735,5.2863679,5.05991273,4.642545,4.263275,3.9221027,3.61987,3.62158,3.35660,3.09162,2.90326,2.714483,2.56422,2.45163,2.26370,2.07534,1.88783,1.775673,1.625412,1.43662,1.32446,1.173778,1.17590,1.100989,1.06502,0.99095,0.95455,0.95711,0.76960,0.69554,0.62147,0.54911,0.58976,0.516122,0.44248,0.44546,0.410769,0.374800,0.37735,0.34223,0.3079706};

double NEvents = 3000;


const int NPoints10GeV = 86;
double EdepCurve10GeVX[NPoints10GeV+1] = {0,0.031639,0.299712,0.499520,0.765675,1.031447,1.296836,1.561073,1.825311,2.088398,2.284755,2.547075,2.742665,3.005369,3.334803,3.530009,3.793096,3.989837,4.253691,4.517545,4.781783,5.047555,5.246979,5.580249,5.982166,6.251390,6.519846,6.789069,7.058293,7.261169,7.464429,7.735570,8.006327,8.344199,8.615723,8.753403,9.023394,9.228187,9.498945,9.836816,10.04199,10.31275,10.51677,10.72118,10.99271,11.26308,11.53346,11.80460,12.07535,12.34611,12.61764,12.75378,13.02339,13.36049,13.56414,13.83374,14.10450,14.30738,14.57698,14.77909,15.04908,15.31869,15.58791,15.85790,16.06001,16.32924,16.66596,16.93518,17.13691,17.27229,17.54151,17.80997,18.01246,18.28168,18.55052,18.81898,19.15493,19.35704,19.62588,19.82722,20.09645,20.43202,20.70047,20.83547,21.03681,21.30604,21.70872};
double EdepCurve10GeVY[NPoints10GeV+1] = {0,0.15999,0.20571428,0.3885714,0.6628571,0.9828571,1.34857142,1.85142857,2.3542857,2.9942857,3.5885714,4.3199999,5.00571428,5.6914285,6.4228571,7.15428571,7.7942857,8.34285714,8.89142857,9.43999999,9.94285714,10.2628571,10.4914285,10.7657142,10.8571428,10.7657142,10.7657142,10.6742857,10.5828571,10.3999999,10.17142857,9.85142857,9.577142857,9.30285714,8.93714285,8.525714285,8.34285714,7.93142857,7.65714285,7.38285714,6.9257142,6.6514285,6.3314285,5.9657142,5.5999999,5.3714285,5.1428571,4.8228571,4.54857142,4.2742857,3.9085714,3.6799999,3.5428571,3.3599999,3.0857142,2.9485714,2.6742857,2.4914285,2.3542857,2.2628571,2.0799999,1.9428571,1.8514285,1.6685714,1.5771428,1.4857142,1.3485714,1.2571428,1.21142857,1.0742857,0.9828571,0.98285714,0.84571428,0.7542857,0.70857142,0.7085714,0.6628571,0.5714285,0.52571428,0.52571428,0.43428571,0.4342857,0.4342857,0.34285714,0.3428571,0.2514285,0.2514285};


const int EVis8GeV = 17;
double EVis8GeVX[EVis8GeV] = {179.5008,183.8209,189.2082,192.0640,197.3891,200.9294,203.7521,207.9954,212.9749,218.3556,224.1864,228.9659,233.3946,237.1004,242.9789,247.0170,259.7471};
double EVis8GeVY[EVis8GeV] = {6.593406,13.736263,28.021978,42.85714,82.96703,113.7362,142.3076,181.3186,214.8351,231.8681,212.0879,178.5714,140.6593,102.7472,63.18681,37.362637,4.395604395};


const int NPoints1GeVTrans = 37;
double EdepCurve1GeVXTransCum[NPoints1GeVTrans+1]={0,0.20045,0.39179,0.58314,0.80182,0.99316,1.18451,1.40318,1.56719,1.78587,2.00455,2.19589,2.38724,2.57858,2.79726,2.96127,3.17995,3.39863,3.58997,3.78132,3.94533,4.16400,4.35535,4.57403,4.76537,4.95671,5.17539,5.44874,5.77676,6.07744,6.48747,6.87015,7.19817,8.10022,9.00227,10.3963,13.2118,17.8314};
double EdepCurve1GeVYTransCum[NPoints1GeVTrans+1]={0,27.733,45.862,57.4876,65.3694,70.6896,74.6305,77.9802,80.3448,82.70935,84.48275,86.25615,87.4384,88.4236,89.4088,90.3940,91.1822,92.1674,92.5615,93.15270,93.7438,94.13793,94.72906,95.12315,95.32019,95.71428,96.10837,96.305418,96.69950,97.093596,97.2906,97.6847,98.07881,98.472906,98.66995,99.0640,99.4581,99.8522};




const int NPoints10GeVTrans = 37;
double EdepCurve10GeVXTransCum[NPoints1GeVTrans+1]={0,0.20045,0.39179,0.58314,0.80182,0.99316,1.18451,1.40318,1.56719,1.78587,2.00455,2.19589,2.38724,2.57858,2.79726,2.96127,3.17995,3.39863,3.58997,3.78132,3.94533,4.16400,4.35535,4.57403,4.76537,4.95671,5.17539,5.44874,5.77676,6.07744,6.48747,6.87015,7.19817,8.10022,9.00227,10.3963,13.2118,17.8314};
double EdepCurve10GeVYTransCum[NPoints1GeVTrans+1]={0,27.733,45.862,57.4876,65.3694,70.6896,74.6305,77.9802,80.3448,82.70935,84.48275,86.25615,87.4384,88.4236,89.4088,90.3940,91.1822,92.1674,92.5615,93.15270,93.7438,94.13793,94.72906,95.12315,95.32019,95.71428,96.10837,96.305418,96.69950,97.093596,97.2906,97.6847,98.07881,98.472906,98.66995,99.0640,99.4581,99.8522};

