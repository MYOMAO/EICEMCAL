#include "TROOT.h"
#include "TH1.h"
#include "TTree.h"
#include "TH2.h"
#include "TAxis.h"
#include "TF1.h"
#include "TFile.h"
#include "TMath.h"
#include "TSystem.h"
#include "TVector2.h"
#include "TLorentzVector.h"
#include "TVector3.h"
#include "TRandom.h"
#include <iostream>
#include <fstream>


using namespace std;

int evtid;
float X1;
float X2;
float Y1;
float Y2;
float Z1;
float Z2;
float T1;
float T2;
float BHBLedep;
float BHFLedep;
float FEMCALedep;
int hitid;
int trkid;
int showerid;
int layer;	
double MinDepth = 292;


const int NPoints1GeV = 75;

double EdepCurve1GeVX[NPoints1GeV+1] = {0,0.148717,0.320847,0.550973,0.838831,1.125625,1.415877,1.648930,1.937320,2.223848,2.455038,2.685963,2.968234,3.194104,3.474513,3.754921,3.976801,4.142545,4.476428,4.642439,4.974459,5.196605,5.471427,5.747046,5.910130,6.130680,6.462168,6.627115,6.958603,7.178620,7.399169,7.564116,7.896935,8.171224,8.393104,8.670852,8.891401,9.169149,9.389698,9.610513,9.831595,10.16468,10.38815,10.60976,10.83138,11.10939,11.33154,11.60982,11.83249,12.16638,12.44439,12.83414,13.11269,13.39097,13.61312,13.89166,14.11407,14.39342,14.56049,14.83957,15.11838,15.34159,15.67681,16.06656,16.34537,16.62418,17.12647,17.46195,17.79663,18.13131,18.52240,18.96908,19.24816,19.58337,19.97419,20.47674};

double EdepCurve1GeVY[NPoints1GeV+1] = {0,1.3340,1.9829,2.93710,4.15834,5.22720,6.79131,8.16452,9.46195,10.4927,11.5992,12.6676,13.0888,13.4334,13.5879,13.7424,13.5155,13.25018,13.06225,12.83494,12.38033,12.19155,11.54602,11.01479,10.368415,9.951048,9.420240,9.040544,8.509737,8.016175,7.59880,7.219112,6.8787911,6.157071,5.930190,5.703735,5.2863679,5.05991273,4.642545,4.263275,3.9221027,3.61987,3.62158,3.35660,3.09162,2.90326,2.714483,2.56422,2.45163,2.26370,2.07534,1.88783,1.775673,1.625412,1.43662,1.32446,1.173778,1.17590,1.100989,1.06502,0.99095,0.95455,0.95711,0.76960,0.69554,0.62147,0.54911,0.58976,0.516122,0.44248,0.44546,0.410769,0.374800,0.37735,0.34223,0.3079706};

double NEvents = 3000;


const int NPoints10GeV = 86;
double EdepCurve10GeVX[NPoints10GeV+1] = {0,0.031639,0.299712,0.499520,0.765675,1.031447,1.296836,1.561073,1.825311,2.088398,2.284755,2.547075,2.742665,3.005369,3.334803,3.530009,3.793096,3.989837,4.253691,4.517545,4.781783,5.047555,5.246979,5.580249,5.982166,6.251390,6.519846,6.789069,7.058293,7.261169,7.464429,7.735570,8.006327,8.344199,8.615723,8.753403,9.023394,9.228187,9.498945,9.836816,10.04199,10.31275,10.51677,10.72118,10.99271,11.26308,11.53346,11.80460,12.07535,12.34611,12.61764,12.75378,13.02339,13.36049,13.56414,13.83374,14.10450,14.30738,14.57698,14.77909,15.04908,15.31869,15.58791,15.85790,16.06001,16.32924,16.66596,16.93518,17.13691,17.27229,17.54151,17.80997,18.01246,18.28168,18.55052,18.81898,19.15493,19.35704,19.62588,19.82722,20.09645,20.43202,20.70047,20.83547,21.03681,21.30604,21.70872};
double EdepCurve10GeVY[NPoints10GeV+1] = {0,0.15999,0.20571428,0.3885714,0.6628571,0.9828571,1.34857142,1.85142857,2.3542857,2.9942857,3.5885714,4.3199999,5.00571428,5.6914285,6.4228571,7.15428571,7.7942857,8.34285714,8.89142857,9.43999999,9.94285714,10.2628571,10.4914285,10.7657142,10.8571428,10.7657142,10.7657142,10.6742857,10.5828571,10.3999999,10.17142857,9.85142857,9.577142857,9.30285714,8.93714285,8.525714285,8.34285714,7.93142857,7.65714285,7.38285714,6.9257142,6.6514285,6.3314285,5.9657142,5.5999999,5.3714285,5.1428571,4.8228571,4.54857142,4.2742857,3.9085714,3.6799999,3.5428571,3.3599999,3.0857142,2.9485714,2.6742857,2.4914285,2.3542857,2.2628571,2.0799999,1.9428571,1.8514285,1.6685714,1.5771428,1.4857142,1.3485714,1.2571428,1.21142857,1.0742857,0.9828571,0.98285714,0.84571428,0.7542857,0.70857142,0.7085714,0.6628571,0.5714285,0.52571428,0.52571428,0.43428571,0.4342857,0.4342857,0.34285714,0.3428571,0.2514285,0.2514285};



const int EVis8GeV = 17;
double EVis8GeVX[EVis8GeV] = {179.5008,183.8209,189.2082,192.0640,197.3891,200.9294,203.7521,207.9954,212.9749,218.3556,224.1864,228.9659,233.3946,237.1004,242.9789,247.0170,259.7471};
double EVis8GeVY[EVis8GeV] = {6.593406,13.736263,28.021978,42.85714,82.96703,113.7362,142.3076,181.3186,214.8351,231.8681,212.0879,178.5714,140.6593,102.7472,63.18681,37.362637,4.395604395};


const int EVis1GeV = 23;
double EVis1GeVX[EVis1GeV]={8.27181,13.6634,15.7901,16.4779,18.2349,19.2706,20.6501,21.3221,21.9842,22.6581,22.9645,23.2629,24.2887,27.0794,29.6843,30.8168,32.3169,33.4949,34.2716,34.6807,36.5366,38.0406,42.7880};
double EVis1GeVY[EVis1GeV]={0.02371,1.13743,9.93448,18.7275,30.2708,42.3616,58.8489,72.0375,87.9734,100.612,115.448,132.482,147.320,171.503,147.335,132.503,115.474,88.0050,72.0731,58.3380,42.4090,24.2813,4.51414};


const int EVis2GeV = 18;
double EVis2GeVX[EVis1GeV]={28.0557,35.5918,39.1553,41.6199,42.9856,44.7229,46.4602,47.4701,49.1758,50.1620,54.3916,58.0776,60.6884,62.9396,64.8152,67.0703,69.6891,74.0747};
double EVis2GeVY[EVis1GeV]={0.07806,5.04382,14.3942,29.2362,49.5696,66.6073,83.6451,102.878,128.707,154.534,178.721,154.006,128.189,102.371,80.9482,54.0314,26.0166,6.79790};


const int EVis4GeV = 19;
double EVis4GeVX[EVis1GeV]={81.2788,85.2079,88.7635,90.8783,92.6333,95.7936,98.2108,100.286,103.438,108.031,114.581,117.170,119.765,121.633,124.601,128.280,132.300,136.654,142.427};
double EVis4GeVY[EVis1GeV]={4.07043,11.7735,23.3217,35.4154,47.5082,68.9454,96.9740,120.056,143.691,166.781,145.920,126.147,104.725,85.4999,60.2334,37.7160,20.1446,9.71707,4.78788};


const int EVis1GeVQuarter = 21;

double EVis1GeVXQuarter[EVis1GeVQuarter] = {4.89749,10.8200,14.4646,15.3758,18.5649,21.2984,24.0318,26.7653,29.4988,32.2323,38.1548,43.6218,45.8997,48.6332,53.1890,56.3781,57.7448,60.9339,64.5785,69.5899,78.7015};
double EVis1GeVYQuarter[EVis1GeVQuarter] = {7.221342,15.7955,23.0189,28.4406,44.7045,55.99783,79.49448,101.635,116.996,133.7132,149.5190,140.015,128.71060,105.2016,78.97661,58.63042,46.87592,31.50148,18.38590,7.075145,1.630825};



const int EVis2GeVQuarter = 29;
double EVis2GeVXQuarter[EVis2GeVQuarter] = {8.08656,13.0979,15.3758,18.5649,19.9316,22.6651,25.3986,28.5876,30.8656,33.5990,37.2437,40.4328,44.0774,47.7220,52.2779,59.5671,67.3120,72.3234,74.6013,79.1571,82.8018,86.9020,89.6355,92.8246,94.6469,99.6583,104.669,111.958,119.248};
double EVis2GeVYQuarter[EVis2GeVQuarter] = {5.858203,10.3666,13.5253,17.1339,29.78623,25.71226,31.58179,42.422042,51.45644,60.9417,73.1369,91.6608,103.855,118.311,133.215,141.3350,130.47012,113.2836,102.8830,86.60154,67.158282,54.49364,43.18803,35.04523,26.90552,18.75860,11.0636,4.71950,1.9911715};



const int EVis4GeVQuarter = 28;
double EVis4GeVXQuarter[EVis4GeVQuarter] = {11.2756,15.3758,21.7539,26.3097,30.4100,36.3325,40.4328,45.4441,49.0888,55.0113,59.1116,65.0341,70.0455,77.7904,89.1799,99.2027,107.403,112.414,117.881,122.892,129.271,135.193,142.027,146.583,152.505,160.706,168.451,178.929};
double EVis4GeVYQuarter[EVis4GeVQuarter] = {5.85099,8.55359,12.1550,17.1164,23.4348,32.9130,40.1353,52.3274,62.2627,75.8086,88.4547,103.356,115.548,130.446,139.460,132.205,115.464,104.153,89.6778,73.3953,58.4656,43.9890,31.7702,24.5282,16.3792,9.12911,5.04382,1.85629};



const int EVis8GeVQuarter = 82;
double EVis8GeVXQuarter[EVis8GeVQuarter] = {5.35307,8.54214,11.7312,15.3758,18.5649,21.7539,24.9430,28.5876,31.7767,34.9658,38.1548,41.3439,44.5330,48.6332,51.8223,54.5558,57.7448,61.3895,64.1230,67.7676,71.4123,74.6013,77.7904,80.9794,84.1685,87.3576,91.0022,94.6469,97.8359,100.569,103.758,106.947,110.592,113.325,117.425,120.615,123.804,126.993,130.182,133.371,137.471,140.205,143.394,147.038,150.227,152.961,157.061,160.250,163.439,166.628,169.817,173.006,177.107,180.296,183.029,186.674,189.863,193.052,196.241,199.886,203.530,206.264,209.453,212.642,215.831,219.020,223.120,225.854,229.043,232.232,235.876,239.066,242.255,245.899,249.088,252.277,255.466,259.111,261.845,265.945,268.678,272.323};
double EVis8GeVYQuarter[EVis8GeVQuarter] = {2.7005392,1.3374001,1.330193,4.937775,8.998365,3.1154524,3.5602229,4.00396381,11.680372,12.125143,17.541665,29.285870,20.23911,29.269397,36.493829,34.227764,39.644286,43.251869,70.816313,62.672483,63.1162245,78.928226,97.452093,113.71607,101.05349,115.96154,112.33749,106.00157,119.55368,120.9034,120.8962,124.9568,137.6039,128.1062,133.5207,154.3044,133.9582,157.4538,129.4240,137.5524,133.92739,143.8647,111.7671,114.0187,113.5595,121.2370,106.31249,105.4013,99.97040,92.73155,96.340167,89.55329,59.261547,71.45773,72.35550,47.94049,67.82029,56.06167,52.89062,47.91063,44.73855,47.44424,27.09805,32.96655,21.207932,24.81654,22.9993693,18.92539,17.11027,17.555049,14.38297,10.30796,13.91657,7.128682,4.861588,4.402404,10.27090,6.646847,1.6689188,3.015584,3.009407,1.1932615};





